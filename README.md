# sync-timer

リアルタイム同期型デュアルフェーズタイマー

## 概要

軽音楽サークルのリハーサルやライブイベント用に設計された、リアルタイム同期タイマーです。  
全ての参加者が同じタイマーを見ながら、管理者が遠隔からスケジュールをコントロールできます。

## 開発目的

- **軽音楽サークルにおけるライブ・リハーサルの円滑化**: リハーサル時間や転換時間を可視化し、イベント進行をスムーズに
- **技術的挑戦**: Firebase Realtime Databaseを用いたリアルタイム同期アプリケーションの開発経験を積む

## 主な機能

- **大画面対応カウントダウン**: ステージディスプレイ向けの大きな表示、スマホでは適切なサイズに自動調整
- **2つの交互フェーズ**: 「演奏」と「転換」の時間を個別設定可能、ループモードもサポート
- **リアルタイム同期**: Firebase Realtime Databaseで全クライアントが同一のタイマー状態を共有
- **管理者モード**: 合言葉で保護されたコントロールパネルから、どのデバイスでもスタート・一時停止・スキップ・リセットが可能
- **セッション管理**: 自動失効機能（2時間）とクライアントID追跡で変更履歴を記録
- **フルスクリーンモード**: キーボード（Fキー）またはボタンで切り替え可能

## 技術スタック

- HTML / CSS / Vanilla JavaScript（ビルド不要）
- Firebase Web SDK v9（モジュラー版）
  - Realtime Database（状態同期）
  - Hosting（静的ホスティング）


## 使い方

### 閲覧モード（全員）

- ブラウザでアクセスするだけで、現在のタイマーとフェーズをリアルタイムで確認できます
- フルスクリーンボタンまたは `F` キーでフルスクリーン表示に切り替え可能

### 管理者モード

1. 「合言葉で管理者ON」ボタンをクリック
2. 事前に決めた合言葉（ひらがな）を入力
3. SHA-256ハッシュ化されてFirebaseに保存され、2時間有効なセッションが作成されます
4. 管理パネルが表示され、以下の操作が可能に：
   - **設定変更**: 演奏時間・転換時間・ループモードの設定
   - **スタート**: タイマー開始
   - **一時停止**: タイマー停止
   - **スキップ**: 次のフェーズへ即座に移行
   - **リセット**: 初期状態に戻す

## セキュリティについて

- 合言葉は全角カタカナ→ひらがな正規化後、SHA-256でハッシュ化
- 管理者セッションは2時間で自動失効
- クライアントIDで操作履歴を記録（`meta/actor`）
- 閲覧は誰でも可能、操作には合言葉が必要

## カスタマイズ

### デザイン変更

`index.html` の `<style>` ブロック内でカラーテーマやフォントサイズを調整可能：

```css
:root{
  --bg:#0b0c10;
  --fg:#e6e6e6;
  --accent-play:#1db954;
  --accent-setup:#ffb020;
  /* ... */
}
```

### デフォルト設定変更

`defaultTimer()` 関数内で初期値を変更：

```javascript
const defaultTimer = () => ({
  // ...
  remainingTime: 15*60*1000,  // 演奏時間（ミリ秒）
  settings:{
    performanceDuration: 15*60*1000,  // 15分
    setupDuration: 5*60*1000,         // 5分
    isLoopMode: true
  }
});
```


## 作者

[@tsuji99999](https://github.com/tsuji99999)